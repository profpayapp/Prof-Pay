<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prof-Pay Admin Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;600&display=swap" rel="stylesheet">
<style>
  body { font-family:'Poppins',sans-serif; background:#f5f7fa; color:#333; padding:2rem;}
  h1 { color:#004080; margin-bottom:1rem; text-align:center; }
  table { width:100%; border-collapse: collapse; margin-top:1.5rem;}
  th, td { border:1px solid #ccc; padding:0.8rem; text-align:center;}
  th { background:#004080; color:white;}
  tr:nth-child(even){background:#f2f2f2;}
</style>
</head>
<body>
<h1>Prof-Pay Admin Transaction Dashboard</h1>
<table>
  <thead>
    <tr>
      <th>User Email</th>
      <th>Service</th>
      <th>Amount</th>
      <th>Payment Method</th>
      <th>Status</th>
      <th>Date</th>
    </tr>
  </thead>
  <tbody id="transactions-table">
    <!-- Transactions will load here -->
  </tbody>
</table>

<script type="module">
import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";

// Firebase config (same as firebase-logging.js)
const firebaseConfig = {
  apiKey: "AIzaSyAV4OESYVvV4uLYD2wxGY2fnxLYJoOzkC0",
  authDomain: "prof-prof.firebaseapp.com",
  projectId: "prof-prof",
  storageBucket: "prof-prof.appspot.com",
  messagingSenderId: "XXXX",
  appId: "XXXX"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

async function loadTransactions(){
  const tableBody = document.getElementById('transactions-table');
  tableBody.innerHTML = '<tr><td colspan="6">Loading...</td></tr>';

  try {
    const querySnapshot = await getDocs(collection(db, "transactions"));
    tableBody.innerHTML = '';
    querySnapshot.forEach((doc) => {
      const tx = doc.data();
      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${tx.user_email || '-'}</td>
        <td>${tx.service || '-'}</td>
        <td>${tx.amount || '-'}</td>
        <td>${tx.payment_method || '-'}</td>
        <td>${tx.status || '-'}</td>
        <td>${tx.date ? new Date(tx.date.seconds * 1000).toLocaleString() : '-'}</td>
      `;
      tableBody.appendChild(row);
    });
  } catch (error) {
    tableBody.innerHTML = `<tr><td colspan="6">Error loading transactions</td></tr>`;
    console.error(error);
  }
}

loadTransactions();
</script>
</body>
</html>
