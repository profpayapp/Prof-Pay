<!-- Airtime Form -->
<div class="airtime-form">
  <h2>Buy Airtime (VTpass Sandbox)</h2>
  <input type="text" id="airtime-phone" placeholder="Enter Phone Number" />
  <input type="number" id="airtime-amount" placeholder="Amount (₦)" />
  <select id="airtime-network">
    <option value="mtn">MTN</option>
    <option value="glo">GLO</option>
    <option value="airtel">AIRTEL</option>
    <option value="9mobile">9MOBILE</option>
  </select>
  <button onclick="buyAirtime()">Send Airtime</button>

  <div id="airtime-response" style="margin-top:10px;"></div>
</div>

<script>
  function generateRequestID() {
    return "profpay_" + Date.now();
  }

  function buyAirtime() {
    const phone = document.getElementById("airtime-phone").value;
    const amount = document.getElementById("airtime-amount").value;
    const network = document.getElementById("airtime-network").value;
    const requestId = generateRequestID();

    const data = {
      request_id: requestId,
      serviceID: "airtime",
      billersCode: phone,
      variation_code: network,
      amount: amount,
      phone: phone
    };

    const responseDiv = document.getElementById("airtime-response");
    responseDiv.innerHTML = "⏳ Sending request...";

    fetch("https://sandbox.vtpass.com/api/pay", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "api-key": "sandbox",
        "public-key": "sandbox@vtpass.com",
        "secret-key": "sandbox"
      },
      body: JSON.stringify(data)
    })
    .then(res => res.json())
    .then(response => {
      console.log("VTpass Response:", response);
      if (response.code === "000") {
        responseDiv.innerHTML = `✅ Success: ${response.content.transactions.transactionId}`;
      } else {
        responseDiv.innerHTML = `❌ Failed: ${response.response_description}`;
      }
    })
    .catch(err => {
      console.error("VTpass Error:", err);
      responseDiv.innerHTML = "❌ Error connecting to VTpass.";
    });
  }
</script>
